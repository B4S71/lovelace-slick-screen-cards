{"version":3,"file":"wind-compass-card.js","sources":["../src/wind-compass-card.ts"],"sourcesContent":[null],"names":["console","info","WindCompassCard","HTMLElement","constructor","this","_bucketSize","_bucketCount","_warnMultiplier","_historyData","_lastHistoryFetch","_currentUnit","_maxSpeed","_currentGust","_limitRaffstore","_limitRollo","getConfigElement","document","createElement","getStubConfig","type","direction_entity","instant_direction_entity","speed_entity","gust_entity","max_speed","hass","_hass","_updateCard","setConfig","config","Error","_recalcBuckets","reqBucketSize","undefined","bucket_size","Number","isNaN","Math","floor","Array","fill","map","duration","totalSpeed","connectedCallback","shadowRoot","attachShadow","mode","_render","content","querySelector","_resizeObserver","ResizeObserver","_updateDimensions","_updateVisuals","observe","disconnectedCallback","disconnect","innerHTML","dirEntity","instantDirEntity","speedEntity","entityGust","entityLimitRaff","raffstore_limit_entity","entityLimitRollo","rollo_limit_entity","warn_multiplier","dirState","states","instDirState","speedState","gustState","_avgDeg","parseFloat","state","_instDeg","_currentSpeed","attributes","unit_of_measurement","now","Date","_fetchHistory","endTime","startTime","getTime","entities","join","history","callApi","toISOString","length","dirHist","find","arr","entity_id","speedHist","_processHistoryData","e","error","dirData","speedData","buckets","speedIdx","i","deg","startTs","last_changed","durationMin","speedVal","bucketIndex","container","width","offsetWidth","_pxPerDeg","_buildTape","tape","maxDur","maxBucketAvgSpeed","forEach","b","avg","limits","filter","l","minLimit","min","alertThreshold","slotWidth","barWidth","max","pxPos","normalizedDeg","data","avgSpeed","isCritical","usedColor","bar","className","heightPct","style","height","left","borderTopColor","background","opacity","freqRatio","toString","appendChild","drawTick","tick","label","directions","textContent","top","transform","marker","diff","speedBar","gustBar","speedText","limitRaff","limitRollo","pct","pctGust","html","round","p","display","getCardSize","customElements","define"],"mappings":"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"}